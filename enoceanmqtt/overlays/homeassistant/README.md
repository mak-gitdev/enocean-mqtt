# Home Assistant Overlay for enoceanmqtt

This is a home assistant overlay for enoceanmqtt.
It allows to easily have EnOcean devices in Home Assistant.
It is based on MQTT discovery from the Home Assistant MQTT integration.

## Installation
For the moment, to install it, perform the following actions:

### 1- Install enoceanmqtt
 - `pip install enocean-mqtt`

### 2- Install TinyDB
 - `pip install tinydb`

### 3- Install the Home Assistant overlay
 - Copy the *__overlay__* folder to enoceanmqtt
 - Replace *__enoceanmqtt.py__*

## Configuration
enoceanmqtt.conf is used as usual, except that:
- *overlay = HA* shall be added in the config section to indicate that the HA overlay is to be used
- *mqtt_discovery_topic = <topic>* shall also be added in the config section, where *<topic>* is the MQTT topic used for discovery and configured in the MQTT integration.

## Usage
You can continue to use enoceanmqtt as usual.

### 1- Pairing your device
If pairing is needed, please follow the instruction of your device regarding pairing.
enoceanmqtt supports pairing through the Python EnOcean library.
Once your device is in pairing mode, the pairing response will be submitted automatically.

Note: For the moment, pairing is always on. Thus it could interfere during your pairing of your device to another EnOcean device. This has been identified and will be fix in a future commit to enable controllable pairing.

### 2- Normal usage
The first EnOcean packet generated by your supported EnOcean device will lead to the discovery of your device in Home Assistant, under the MQTT integration's devices and entities.
At this moment, your device is stored in a database of known devices and any other packets will be handled as usual by enoceanmqtt.

### 3- Delete your device from Home Assistant
If you want to delete your device from Home Assistant:
 - Browse to the devices of MQTT integration
 - Click on your device
 - Click on the delete button in the configuration section

## Supported Devices
Note: If your device is not supported yet, please feel free to ask me for adding your device or feel free to add it to *__mapping.yaml__* and make a pull request.
 - `D2-01-0B`
 - `D2-01-0C`
 - `D2-01-0F` (not tested)
 - `D2-01-12`
 - `D2-05-00` (not tested)
 - `F6-02-01`
 - `F6-02-02` (not tested)
 - `D5-00-01`
 - `A5-12-00` (not tested)
 - `A5-12-01` (not tested)

For devices not yet supported, only the RSSI sensor is created in Home Assistant.